<!-- #include file="../../Scripts/Inc/Cache.Inc" --><!-- #include file="../../Scripts/Inc/Fechas.inc" --><!-- #include file="../../Scripts/Inc/Caracteres.inc" --><!-- #include file="../../Scripts/Inc/Montoescrito.Inc" --><%	Cache  Etiqueta_post = request("Etiqueta")       	Function TxtPrint(Margen_izquierdo,valor)    valor = cambia_chr(valor)		if Instr(1,valor,chr(13)) > 0 then			cTexto = ""			caracter = "¬"			valor = Replace(valor,chr(13),caracter)			Do While Instr(1,valor,caracter) > 0 				nPosIni = Instr(1,valor,caracter)				cTexto = cTexto & "Locales.imprimir " & chr(34) & space(Margen_izquierdo) & Mid(valor,1,nPosIni-1) & chr(34) & chr(13)				valor =  Mid(valor,nPosIni+1)			Loop			cTexto = cTexto & "Locales.imprimir " & chr(34) & space(Margen_izquierdo) & valor & chr(34) & chr(13)			TxtPrint = cTexto		else			TxtPrint = "Locales.imprimir " & chr(34) & valor & chr(34)		end if	End FunctionFunction floor(num)num = cstr(num)arrNumber= split(num, ".")num = arrNumber(0)floor = cint(num)end function%><% Session.LCID = 11274 %><html><body><table border=1><tr><td><table align=left width=10% border=0><tr><td NOWRAP><font size=1><%Const adUseClient = 3Dim conn1conn1 = Session("DataConn_ConnectionString")	Cantidad = Floor( ( cdbl(request("Cantidad")) - 1 ) / 3 ) + 1Linea1 = trim(left(request("text1"),21))Linea2 = trim(mid(request("text1")&space(23),22))If Etiqueta_post = "Etiqueta_1" thentext1=request("text1")largo1=LEN(text1)largo_base=10if (largo_base-largo1)<=1 then calculo = 0 else calculo = (largo_base-largo1) end iflargo2=round(((calculo)/2),0)espacios=""ajuste=request("ajuste")if ajuste="C" then  if largo1<12 then     if calculo=0 then largo2=largo2 else largo2=largo2+1 end if    espacios=space(largo2)  else     largo2=largo2+1    espacios=space(largo2)  end ifelse  espacios=space(0)end if  Puerto1 = "LPT1"  Etiqueta = "^XA" & chr(13) & _             "^PQ" & request("Cantidad") & chr(13) & _             "^LH0,10" & chr(13) & _             "^FO30,50^A0,90,40^FD" & espacios & UCASE(request("text1")) & "^FS" & chr(13) & _             "^LH290,10" & chr(13) & _             "^FO20,50^A0,90,40^FD" & espacios & UCASE(request("text1")) & "^FS" & chr(13) & _             "^LH585,10" & chr(13) & _             "^FO06,50^A0,90,40^FD" & espacios & UCASE(request("text1")) & "^FS" & chr(13) & _             "^XZ"  Etiqueta = TxtPrint(0,Etiqueta)  ElseIf Etiqueta_post = "Etiqueta_2" thentext1=request("text1")text2=request("text2")largo1=LEN(text1)largo2=LEN(text2)largo_base   = 13largo_base_1 = 13if (largo_base-largo1)<=1 then calculo = 0 else calculo = (largo_base-largo1) end ifif (largo_base_1-largo2)<=1 then calculo_1 = 0 else calculo_1 = (largo_base_1-largo2) end iflargo2=round(((calculo)/2),0)largo2_1=round(((calculo_1)/2),0)espacios=""ajuste=request("ajuste")if ajuste="C" then  if largo1<10 then     if calculo=0 then largo2=largo2 else largo2=largo2+1 end if    espacios=space(largo2)  else     largo2=largo2+0    if largo2-1<0 then largo2=0 else largo2=largo2-1     espacios=space(largo2)  end ifelse  espacios=space(0)end ifif ajuste="C" then  if largo2<10 then     if calculo_1=0 then largo2_1=largo2_1 else largo2_1=largo2_1+1 end if    espacios_1=space(largo2_1)  else     largo2_1=largo2_1+0    if largo2-1<0 then largo2=0 else largo2=largo2-1    espacios_1=space(largo2_1)  end ifelse  espacios_1=space(0)end if  Puerto1 = "LPT1"  Etiqueta = "^XA" & chr(13) & _             "^PQ" & request("Cantidad") & chr(13) & _             "^LH0,10" & chr(13) & _             "^FO28,25^A0,58,40^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO28,100^A0,58,40^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^LH290,10" & chr(13) & _             "^FO18,25^A0,58,40^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO18,100^A0,58,40^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _                          "^LH585,10" & chr(13) & _             "^FO04,25^A0,58,42^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO04,100^A0,58,40^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _                          "^XZ"  Etiqueta = TxtPrint(0,Etiqueta)  ElseIf Etiqueta_post = "Etiqueta_3" thentext1=request("text1")text2=request("text2")text3=request("text3")largo1=LEN(text1)largo2=LEN(text2)largo3=LEN(text3)largo_base   = 18largo_base_1 = 10largo_base_2 = 18if (largo_base-largo1)<=1 then calculo = 0 else calculo = (largo_base-largo1) end ifif (largo_base_1-largo2)<=1 then calculo_1 = 0 else calculo_1 = (largo_base_1-largo2) end ifif (largo_base_2-largo3)<=1 then calculo_2 = 0 else calculo_2 = (largo_base_2-largo3) end iflargo2=round(((calculo)/2),0)largo2_1=round(((calculo_1)/2),0)largo2_2=round(((calculo_2)/2),0)espacios=""ajuste=request("ajuste")if ajuste="C" then  if largo1<10 then     if calculo=0 then largo2=largo2 else largo2=largo2+1 end if    espacios=space(largo2)  else     largo2=largo2+1    espacios=space(largo2)  end ifelse  espacios=space(0)end ifif ajuste="C" then  if largo2<10 then     if calculo_1=0 then largo2_1=largo2_1 else largo2_1=largo2_1+1 end if    espacios_1=space(largo2_1)  else     largo2_1=largo2_1+1    espacios_1=space(largo2_1)  end ifelse  espacios_1=space(0)end ifif ajuste="C" then  if largo3<10 then     if calculo_2=0 then largo2_2=largo2_2 else largo2_2=largo2_2+1 end if    espacios_2=space(largo2_2)  else     largo2_2=largo2_2+1    espacios_2=space(largo2_2)  end ifelse  espacios_2=space(0)end if  Puerto1 = "LPT1"  Etiqueta = "^XA" & chr(13) & _             "^PQ" & request("Cantidad") & chr(13) & _             "^LH0,10" & chr(13) & _             "^FO28,20^A0,40,30^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO28,60^A0,80,50^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^FO28,130^A0,40,30^FD" & espacios_2 & request("text3") & "^FS" & chr(13) & _                          "^LH290,10" & chr(13) & _             "^FO20,20^A0,40,30^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO20,60^A0,80,50^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^FO20,130^A0,40,30^FD" & espacios_2 & request("text3") & "^FS" & chr(13) & _                          "^LH585,10" & chr(13) & _             "^FO08,20^A0,40,30^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO08,60^A0,80,50^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^FO08,130^A0,40,30^FD" & espacios_2 & request("text3") & "^FS" & chr(13) & _                          "^XZ"  Etiqueta = TxtPrint(0,Etiqueta)  ElseIf Etiqueta_post = "Etiqueta_4" thentext1=request("text1")text2=request("text2")text3=request("text3")text4=request("text4")largo1=LEN(text1)largo2=LEN(text2)largo3=LEN(text3)largo4=LEN(text4)largo_base   = 17largo_base_1 = 10largo_base_2 = 23largo_base_3 = 23if (largo_base-largo1)<=1 then calculo = 0 else calculo = (largo_base-largo1) end ifif (largo_base_1-largo2)<=1 then calculo_1 = 0 else calculo_1 = (largo_base_1-largo2) end ifif (largo_base_2-largo3)<=1 then calculo_2 = 0 else calculo_2 = (largo_base_2-largo3) end ifif (largo_base_3-largo3)<=1 then calculo_3 = 0 else calculo_3 = (largo_base_3-largo4) end iflargo2=round(((calculo)/2),0)largo2_1=round(((calculo_1)/2),0)largo2_2=round(((calculo_2)/2),0)largo2_3=round(((calculo_3)/2),0)espacios=""espacios_1=""espacios_2=""espacios_3=""ajuste=request("ajuste")if ajuste="C" then  if largo1<10 then     if calculo=0 then largo2=largo2 else largo2=largo2-1 end if    espacios=space(largo2)  else     largo2=largo2+1    espacios=space(largo2)  end ifelse  espacios=space(0)end ifif ajuste="C" then  if largo2<8 then     if calculo_1=0 then largo2_1=largo2_1 else largo2_1=largo2_1+1 end if    espacios_1=space(largo2_1)  else     largo2_1=largo2_1+1    espacios_1=space(largo2_1)  end ifelse  espacios_1=space(0)end ifif ajuste="C" then  if largo3<14 then     if calculo_2=0 then largo2_2=largo2_2 else largo2_2=largo2_2+3 end if    espacios_2=space(largo2_2)  else     largo2_2=largo2_2+1    espacios_2=space(largo2_2)  end ifelse  espacios_2=space(0)end ifif ajuste="C" then  if largo4<14 then     if calculo_3=0 then largo2_3=largo2_3 else largo2_3=largo2_3+3 end if    espacios_3=space(largo2_3)  else     largo2_3=largo2_3+1    espacios_3=space(largo2_3)  end ifelse  espacios_3=space(0)end if  Puerto1 = "LPT1"  Etiqueta = "^XA" & chr(13) & _             "^PQ" & request("Cantidad") & chr(13) & _             "^LH0,10" & chr(13) & _             "^FO30,10^A0,40,30^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO30,46^A0,80,50^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^FO30,113^A0,30,20^FD" & espacios_2 & request("text3") & "^FS" & chr(13) & _                          "^FO30,139^A0,30,20^FD" & espacios_3 & request("text4") & "^FS" & chr(13) & _                          "^LH290,10" & chr(13) & _             "^FO23,10^A0,40,30^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO23,46^A0,80,50^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^FO23,113^A0,30,20^FD" & espacios_2 & request("text3") & "^FS" & chr(13) & _                          "^FO23,139^A0,30,20^FD" & espacios_3 & request("text4") & "^FS" & chr(13) & _                          "^LH585,10" & chr(13) & _             "^FO08,10^A0,40,30^FD" & espacios & request("text1") & "^FS" & chr(13) & _             "^FO08,46^A0,80,50^FD" & espacios_1 & request("text2") & "^FS" & chr(13) & _             "^FO08,113^A0,30,20^FD" & espacios_2 & request("text3") & "^FS" & chr(13) & _                          "^FO08,139^A0,30,20^FD" & espacios_3 & request("text4") & "^FS" & chr(13) & _                          "^XZ"  Etiqueta = TxtPrint(0,Etiqueta)  ElseIf Etiqueta_post = "Etiqueta_5" then  Puerto1 = "LPT1"  Etiqueta = "^XA" & chr(13) & _             "^PQ" & request("Cantidad") & chr(13) & _             "^LH0,10" & chr(13) & _             "^FO28,20^A0,30,25^FD" & request("text1") & "^FS" & chr(13) & _             "^FO28,50^A0,30,25^FD" & request("text2") & "^FS" & chr(13) & _             "^FO28,80^A0,30,25^FD" & request("text3") & "^FS" & chr(13) & _                          "^FO28,110^A0,30,25^FD" & request("text4") & "^FS" & chr(13) & _             "^FO28,140^A0,30,25^FD" & request("text5") & "^FS" & chr(13) & _                                       "^LH290,10" & chr(13) & _             "^FO20,20^A0,30,25^FD" & request("text1") & "^FS" & chr(13) & _             "^FO20,50^A0,30,25^FD" & request("text2") & "^FS" & chr(13) & _             "^FO20,80^A0,30,25^FD" & request("text3") & "^FS" & chr(13) & _                          "^FO20,110^A0,30,25^FD" & request("text4") & "^FS" & chr(13) & _             "^FO20,140^A0,30,25^FD" & request("text5") & "^FS" & chr(13) & _                                       "^LH585,10" & chr(13) & _             "^FO08,20^A0,30,25^FD" & request("text1") & "^FS" & chr(13) & _             "^FO08,50^A0,30,25^FD" & request("text2") & "^FS" & chr(13) & _             "^FO08,80^A0,30,25^FD" & request("text3") & "^FS" & chr(13) & _                          "^FO08,110^A0,30,25^FD" & request("text4") & "^FS" & chr(13) & _             "^FO08,140^A0,30,25^FD" & request("text5") & "^FS" & chr(13) & _                                       "^XZ"  Etiqueta = TxtPrint(0,Etiqueta) ElseIf Etiqueta_post = "Etiqueta_6" then  Puerto1 = "LPT1"  Etiqueta = "^XA" & chr(13) & _             "^PQ" & request("Cantidad") & chr(13) & _             "^LH0,10" & chr(13) & _             "^FO40,25^A0,18,15^FD" & request("text1") & "^FS" & chr(13) & _             "^FO40,45^A0,18,15^FD" & request("text2") & "^FS" & chr(13) & _                          "^FO40,65^A0,18,15^FD" & request("text3") & "^FS" & chr(13) & _             "^FO40,85^A0,18,15^FD" & request("text4") & "^FS" & chr(13) & _             "^FO40,105^A0,18,15^FD" & request("text5") & "^FS" & chr(13) & _             "^FO40,125^A0,18,15^FD" & request("text6") & "^FS" & chr(13) & _             "^FO40,145^A0,18,15^FD" & request("text7") & "^FS" & chr(13) & _                         "^LH290,10" & chr(13) & _             "^FO30,25^A0,18,15^FD" & request("text1") & "^FS" & chr(13) & _             "^FO30,45^A0,18,15^FD" & request("text2") & "^FS" & chr(13) & _                          "^FO30,65^A0,18,15^FD" & request("text3") & "^FS" & chr(13) & _             "^FO30,85^A0,18,15^FD" & request("text4") & "^FS" & chr(13) & _             "^FO30,105^A0,18,15^FD" & request("text5") & "^FS" & chr(13) & _             "^FO30,125^A0,18,15^FD" & request("text6") & "^FS" & chr(13) & _             "^FO30,145^A0,18,15^FD" & request("text7") & "^FS" & chr(13) & _                         "^LH585,10" & chr(13) & _             "^FO16,25^A0,18,15^FD" & request("text1") & "^FS" & chr(13) & _             "^FO16,45^A0,18,15^FD" & request("text2") & "^FS" & chr(13) & _                          "^FO16,65^A0,18,15^FD" & request("text3") & "^FS" & chr(13) & _             "^FO16,85^A0,18,15^FD" & request("text4") & "^FS" & chr(13) & _             "^FO16,105^A0,18,15^FD" & request("text5") & "^FS" & chr(13) & _             "^FO16,125^A0,18,15^FD" & request("text6") & "^FS" & chr(13) & _             "^FO16,145^A0,18,15^FD" & request("text7") & "^FS" & chr(13) & _                         "^XZ"  Etiqueta = TxtPrint(0,Etiqueta)End If%></font></td></tr></table></table></tr></td></body></html><OBJECT classid="CLSID:B829BCD0-3892-11D3-A519-0000216ABE11" 	      codebase="../../Impresion/Impresora.CAB#version=2,0,0,1" 		id=Locales style="LEFT: 0px; TOP: 0px">		<PARAM NAME="_ExtentX" VALUE="503">		<PARAM NAME="_ExtentY" VALUE="503">	</OBJECT>	<Script language="VBScript">	    Dim Puerto    			If Locales.InicioImpresion("LPT1") then			<%=Etiqueta%>				Locales.FinImpresion			Else				Msgbox "Verifique el estado de la impresora",16,"Error" 				End if</Script>