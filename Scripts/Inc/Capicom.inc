<SCRIPT RUNAT=SERVER LANGUAGE="VBscript">
	Const CAPICOM_ENCODE_BASE64			= 0
	Const CAPICOM_HASH_ALGORITHM_SHA1		= 0

	Const CAPICOM_ENCRYPTION_ALGORITHM_RC2		= 0
	Const CAPICOM_ENCRYPTION_ALGORITHM_RC4		= 1
 	Const CAPICOM_ENCRYPTION_ALGORITHM_DES		= 2
  	Const CAPICOM_ENCRYPTION_ALGORITHM_3DES		= 3


	Const CAPICOM_KEY_LENGTH_MAXIMUM = 0 ' Use the maximum key length available...
	Const CAPICOM_KEY_LENGTH_40_BITS = 1 ' Use 40-bit keys. 
	Const CAPICOM_KEY_LENGTH_56_BITS = 2 ' Use 56-bit keys if available. 
	Const CAPICOM_KEY_LENGTH_128_BITS = 3 ' Use 128-bit keys if available 

	Function AscToISO8859( cChar ) 
		Dim nLen, cFinal, i, cIte
	    cFinal = ""
	    nLen = Len(cChar)
	    For i = 1 To nLen
	        cIte = Mid(cChar, i, 1)
	        If InStr("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ $%/()=,.;:_*+", cIte) > 0 Then
	            cFinal = cFinal & cIte
	        ElseIf cIte = Chr(34) Then
	            cFinal = cFinal & "&quot;"
	        ElseIf cIte = "'" Then
	            cFinal = cFinal & "&apos;"
	        ElseIf cIte = "&" Then
	            cFinal = cFinal & "&amp;"
	        ElseIf cIte = "<" Then
	            cFinal = cFinal & "&lt;"
	        ElseIf cIte = ">" Then
	            cFinal = cFinal & "&gt;"
	        ElseIf cIte = " " Then
	            cFinal = cFinal & "&nbsp;"
	        ElseIf cIte = "¡" Then
	            cFinal = cFinal & "&iexcl;"
	        ElseIf cIte = "¢" Then
	            cFinal = cFinal & "&cent;"
	        ElseIf cIte = "£" Then
	            cFinal = cFinal & "&pound;"
	        ElseIf cIte = "¤" Then
	            cFinal = cFinal & "&curren;"
	        ElseIf cIte = "¥" Then
	            cFinal = cFinal & "&yen;"
	        ElseIf cIte = "¦" Then
	            cFinal = cFinal & "&brvbar;"
	        ElseIf cIte = "§" Then
	            cFinal = cFinal & "&sect;"
	        ElseIf cIte = "¨" Then
	            cFinal = cFinal & "&uml;"
	        ElseIf cIte = "©" Then
	            cFinal = cFinal & "&copy;"
	        ElseIf cIte = "ª" Then
	            cFinal = cFinal & "&ordf;"
	        ElseIf cIte = "«" Then
	            cFinal = cFinal & "&laquo;"
	        ElseIf cIte = "¬" Then
	            cFinal = cFinal & "&not;"
	        ElseIf cIte = "­" Then
	            cFinal = cFinal & "&shy;"
	        ElseIf cIte = "®" Then
	            cFinal = cFinal & "&reg;"
	        ElseIf cIte = "¯" Then
	            cFinal = cFinal & "&macr;"
	        ElseIf cIte = "°" Then
	            cFinal = cFinal & "&deg;"
	        ElseIf cIte = "±" Then
	            cFinal = cFinal & "&plusmn;"
	        ElseIf cIte = "²" Then
	            cFinal = cFinal & "&sup2;"
	        ElseIf cIte = "³" Then
	            cFinal = cFinal & "&sup3;"
	        ElseIf cIte = "´" Then
	            cFinal = cFinal & "&acute;"
	        ElseIf cIte = "µ" Then
	            cFinal = cFinal & "&micro;"
	        ElseIf cIte = "¶" Then
	            cFinal = cFinal & "&para;"
	        ElseIf cIte = "·" Then
	            cFinal = cFinal & "&middot;"
	        ElseIf cIte = "¸" Then
	            cFinal = cFinal & "&cedil;"
	        ElseIf cIte = "¹" Then
	            cFinal = cFinal & "&sup1;"
	        ElseIf cIte = "º" Then
	            cFinal = cFinal & "&ordm;"
	        ElseIf cIte = "»" Then
	            cFinal = cFinal & "&raquo;"
	        ElseIf cIte = "¼" Then
	            cFinal = cFinal & "&frac14;"
	        ElseIf cIte = "½" Then
	            cFinal = cFinal & "&frac12;"
	        ElseIf cIte = "¾" Then
	            cFinal = cFinal & "&frac34;"
	        ElseIf cIte = "¿" Then
	            cFinal = cFinal & "&iquest;"
	        ElseIf cIte = "À" Then
	            cFinal = cFinal & "&Agrave;"
	        ElseIf cIte = "Á" Then
	            cFinal = cFinal & "&Aacute;"
	        ElseIf cIte = "Â" Then
	            cFinal = cFinal & "&Acirc;"
	        ElseIf cIte = "Ã" Then
	            cFinal = cFinal & "&Atilde;"
	        ElseIf cIte = "Ä" Then
	            cFinal = cFinal & "&Auml;"
	        ElseIf cIte = "Å" Then
	            cFinal = cFinal & "&Aring;"
	        ElseIf cIte = "Æ" Then
	            cFinal = cFinal & "&AElig;"
	        ElseIf cIte = "Ç" Then
	            cFinal = cFinal & "&Ccedil;"
	        ElseIf cIte = "È" Then
	            cFinal = cFinal & "&Egrave;"
	        ElseIf cIte = "É" Then
	            cFinal = cFinal & "&Eacute;"
	        ElseIf cIte = "Ê" Then
	            cFinal = cFinal & "&Ecirc;"
	        ElseIf cIte = "Ë" Then
	            cFinal = cFinal & "&Euml;"
	        ElseIf cIte = "Ì" Then
	            cFinal = cFinal & "&Igrave;"
	        ElseIf cIte = "Í" Then
	            cFinal = cFinal & "&Iacute;"
	        ElseIf cIte = "Î" Then
	            cFinal = cFinal & "&Icirc;"
	        ElseIf cIte = "Ï" Then
	            cFinal = cFinal & "&Iuml;"
	        ElseIf cIte = "Ð" Then
	            cFinal = cFinal & "&ETH;"
	        ElseIf cIte = "Ñ" Then
	            cFinal = cFinal & "&Ntilde;"
	        ElseIf cIte = "Ò" Then
	            cFinal = cFinal & "&Ograve;"
	        ElseIf cIte = "Ó" Then
	            cFinal = cFinal & "&Oacute;"
	        ElseIf cIte = "Ô" Then
	            cFinal = cFinal & "&Ocirc;"
	        ElseIf cIte = "Õ" Then
	            cFinal = cFinal & "&Otilde;"
	        ElseIf cIte = "Ö" Then
	            cFinal = cFinal & "&Ouml;"
	        ElseIf cIte = "×" Then
	            cFinal = cFinal & "&times;"
	        ElseIf cIte = "Ø" Then
	            cFinal = cFinal & "&Oslash;"
	        ElseIf cIte = "Ù" Then
	            cFinal = cFinal & "&Ugrave;"
	        ElseIf cIte = "Ú" Then
	            cFinal = cFinal & "&Uacute;"
	        ElseIf cIte = "Û" Then
	            cFinal = cFinal & "&Ucirc;"
	        ElseIf cIte = "Ü" Then
	            cFinal = cFinal & "&Uuml;"
	        ElseIf cIte = "Ý" Then
	            cFinal = cFinal & "&Yacute;"
	        ElseIf cIte = "Þ" Then
	            cFinal = cFinal & "&THORN;"
	        ElseIf cIte = "ß" Then
	            cFinal = cFinal & "&szlig;"
	        ElseIf cIte = "à" Then
	            cFinal = cFinal & "&agrave;"
	        ElseIf cIte = "á" Then
	            cFinal = cFinal & "&aacute;"
	        ElseIf cIte = "â" Then
	            cFinal = cFinal & "&acirc;"
	        ElseIf cIte = "ã" Then
	            cFinal = cFinal & "&atilde;"
	        ElseIf cIte = "ä" Then
	            cFinal = cFinal & "&auml;"
	        ElseIf cIte = "å" Then
	            cFinal = cFinal & "&aring;"
	        ElseIf cIte = "æ" Then
	            cFinal = cFinal & "&aelig;"
	        ElseIf cIte = "ç" Then
	            cFinal = cFinal & "&ccedil;"
	        ElseIf cIte = "è" Then
	            cFinal = cFinal & "&egrave;"
	        ElseIf cIte = "é" Then
	            cFinal = cFinal & "&eacute;"
	        ElseIf cIte = "ê" Then
	            cFinal = cFinal & "&ecirc;"
	        ElseIf cIte = "ë" Then
	            cFinal = cFinal & "&euml;"
	        ElseIf cIte = "ì" Then
	            cFinal = cFinal & "&igrave;"
	        ElseIf cIte = "í" Then
	            cFinal = cFinal & "&iacute;"
	        ElseIf cIte = "î" Then
	            cFinal = cFinal & "&icirc;"
	        ElseIf cIte = "ï" Then
	            cFinal = cFinal & "&iuml;"
	        ElseIf cIte = "ð" Then
	            cFinal = cFinal & "&eth;"
	        ElseIf cIte = "ñ" Then
	            cFinal = cFinal & "&ntilde;"
	        ElseIf cIte = "ò" Then
	            cFinal = cFinal & "&ograve;"
	        ElseIf cIte = "ó" Then
	            cFinal = cFinal & "&oacute;"
	        ElseIf cIte = "ô" Then
	            cFinal = cFinal & "&ocirc;"
	        ElseIf cIte = "õ" Then
	            cFinal = cFinal & "&otilde;"
	        ElseIf cIte = "ö" Then
	            cFinal = cFinal & "&ouml;"
	        ElseIf cIte = "÷" Then
	            cFinal = cFinal & "&divide;"
	        ElseIf cIte = "ø" Then
	            cFinal = cFinal & "&oslash;"
	        ElseIf cIte = "ù" Then
	            cFinal = cFinal & "&ugrave;"
	        ElseIf cIte = "ú" Then
	            cFinal = cFinal & "&uacute;"
	        ElseIf cIte = "û" Then
	            cFinal = cFinal & "&ucirc;"
	        ElseIf cIte = "ü" Then
	            cFinal = cFinal & "&uuml;"
	        ElseIf cIte = "ý" Then
	            cFinal = cFinal & "&yacute;"
	        ElseIf cIte = "þ" Then
	            cFinal = cFinal & "&thorn;"
	        ElseIf cIte = "ÿ" Then
	            cFinal = cFinal & "&yuml;"
	        Else
	            cFinal = cFinal & cIte
	        End If
	    Next
	    AscToISO8859 = cFinal
	End Function

	Function AscToISO8859Entities( cChar ) 
		Dim nLen, cFinal, i, cIte
	    cFinal = ""
            if IsNull(cChar) then cChar = ""
	    nLen = Len(cChar)
	    For i = 1 To nLen
	        cIte = Mid(cChar, i, 1)
	        If InStr("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ $%/()=,.;:_*+", cIte) > 0 Then
	            cFinal = cFinal & cIte
	        ElseIf cIte = Chr(34) Then
	            cFinal = cFinal & "&#34;"
	        ElseIf cIte = "'" Then
	            cFinal = cFinal & "&#39;"
	        ElseIf cIte = "&" Then
	            cFinal = cFinal & "&#38;"
	        ElseIf cIte = "<" Then
	            cFinal = cFinal & "&#60;"
	        ElseIf cIte = ">" Then
	            cFinal = cFinal & "&#62;"
	        ElseIf cIte = " " Then
	            cFinal = cFinal & "&#160;"
	        ElseIf cIte = "¡" Then
	            cFinal = cFinal & "&#161;"
	        ElseIf cIte = "¤" Then
	            cFinal = cFinal & "&#164;"
	        ElseIf cIte = "¢" Then
	            cFinal = cFinal & "&#162;"
	        ElseIf cIte = "£" Then
	            cFinal = cFinal & "&#163;"
	        ElseIf cIte = "¥" Then
	            cFinal = cFinal & "&#165;"
	        ElseIf cIte = "¦" Then
	            cFinal = cFinal & "&#166;"
	        ElseIf cIte = "§" Then
	            cFinal = cFinal & "&#167;"
	        ElseIf cIte = "¨" Then
	            cFinal = cFinal & "&#168;"
	        ElseIf cIte = "©" Then
	            cFinal = cFinal & "&#169;"
	        ElseIf cIte = "ª" Then
	            cFinal = cFinal & "&#170;"
	        ElseIf cIte = "«" Then
	            cFinal = cFinal & "&#171;"
	        ElseIf cIte = "¬" Then
	            cFinal = cFinal & "&#172;"
	        ElseIf cIte = "­" Then
	            cFinal = cFinal & "&#173;"
	        ElseIf cIte = "®" Then
	            cFinal = cFinal & "&#174;"
	        ElseIf cIte = "¯" Then
	            cFinal = cFinal & "&#175;"
	        ElseIf cIte = "°" Then
	            cFinal = cFinal & "&#176;"
	        ElseIf cIte = "±" Then
	            cFinal = cFinal & "&#177;"
	        ElseIf cIte = "²" Then
	            cFinal = cFinal & "&#178;"
	        ElseIf cIte = "³" Then
	            cFinal = cFinal & "&#179;"
	        ElseIf cIte = "´" Then
	            cFinal = cFinal & "&#180;"
	        ElseIf cIte = "µ" Then
	            cFinal = cFinal & "&#181;"
	        ElseIf cIte = "¶" Then
	            cFinal = cFinal & "&#182;"
	        ElseIf cIte = "·" Then
	            cFinal = cFinal & "&#183;"
	        ElseIf cIte = "¸" Then
	            cFinal = cFinal & "&#184;"
	        ElseIf cIte = "¹" Then
	            cFinal = cFinal & "&#185;"
	        ElseIf cIte = "º" Then
	            cFinal = cFinal & "&#186;"
	        ElseIf cIte = "»" Then
	            cFinal = cFinal & "&#187;"
	        ElseIf cIte = "¼" Then
	            cFinal = cFinal & "&#188;"
	        ElseIf cIte = "½" Then
	            cFinal = cFinal & "&#189;"
	        ElseIf cIte = "¾" Then
	            cFinal = cFinal & "&#190;"
	        ElseIf cIte = "¿" Then
	            cFinal = cFinal & "&#191;"
	        ElseIf cIte = "À" Then
	            cFinal = cFinal & "&#192;"
	        ElseIf cIte = "Á" Then
	            cFinal = cFinal & "&#193;"
	        ElseIf cIte = "Â" Then
	            cFinal = cFinal & "&#194;"
	        ElseIf cIte = "Ã" Then
	            cFinal = cFinal & "&#195;"
	        ElseIf cIte = "Ä" Then
	            cFinal = cFinal & "&#196;"
	        ElseIf cIte = "Å" Then
	            cFinal = cFinal & "&#197;"
	        ElseIf cIte = "Æ" Then
	            cFinal = cFinal & "&#198;"
	        ElseIf cIte = "Ç" Then
	            cFinal = cFinal & "&#199;"
	        ElseIf cIte = "È" Then
	            cFinal = cFinal & "&#200;"
	        ElseIf cIte = "É" Then
	            cFinal = cFinal & "&#201;"
	        ElseIf cIte = "Ê" Then
	            cFinal = cFinal & "&#202;"
	        ElseIf cIte = "Ë" Then
	            cFinal = cFinal & "&#203;"
	        ElseIf cIte = "Ì" Then
	            cFinal = cFinal & "&#204;"
	        ElseIf cIte = "Í" Then
	            cFinal = cFinal & "&#205;"
	        ElseIf cIte = "Î" Then
	            cFinal = cFinal & "&#206;"
	        ElseIf cIte = "Ï" Then
	            cFinal = cFinal & "&#207;"
	        ElseIf cIte = "Ð" Then
	            cFinal = cFinal & "&#208;"
	        ElseIf cIte = "Ñ" Then
	            cFinal = cFinal & "&#209;"
	        ElseIf cIte = "Ò" Then
	            cFinal = cFinal & "&#210;"
	        ElseIf cIte = "Ó" Then
	            cFinal = cFinal & "&#211;"
	        ElseIf cIte = "Ô" Then
	            cFinal = cFinal & "&#212;"
	        ElseIf cIte = "Õ" Then
	            cFinal = cFinal & "&#213;"
	        ElseIf cIte = "Ö" Then
	            cFinal = cFinal & "&#214;"
	        ElseIf cIte = "×" Then
	            cFinal = cFinal & "&#215;"
	        ElseIf cIte = "Ø" Then
	            cFinal = cFinal & "&#216;"
	        ElseIf cIte = "Ù" Then
	            cFinal = cFinal & "&#217;"
	        ElseIf cIte = "Ú" Then
	            cFinal = cFinal & "&#218;"
	        ElseIf cIte = "Û" Then
	            cFinal = cFinal & "&#219;"
	        ElseIf cIte = "Ü" Then
	            cFinal = cFinal & "&#220;"
	        ElseIf cIte = "Ý" Then
	            cFinal = cFinal & "&#221;"
	        ElseIf cIte = "Þ" Then
	            cFinal = cFinal & "&#222;"
	        ElseIf cIte = "ß" Then
	            cFinal = cFinal & "&#223;"
	        ElseIf cIte = "à" Then
	            cFinal = cFinal & "&#224;"
	        ElseIf cIte = "á" Then
	            cFinal = cFinal & "&#225;"
	        ElseIf cIte = "â" Then
	            cFinal = cFinal & "&#226;"
	        ElseIf cIte = "ã" Then
	            cFinal = cFinal & "&#227;"
	        ElseIf cIte = "ä" Then
	            cFinal = cFinal & "&#228;"
	        ElseIf cIte = "å" Then
	            cFinal = cFinal & "&#229;"
	        ElseIf cIte = "æ" Then
	            cFinal = cFinal & "&#230;"
	        ElseIf cIte = "ç" Then
	            cFinal = cFinal & "&#231;"
	        ElseIf cIte = "è" Then
	            cFinal = cFinal & "&#232;"
	        ElseIf cIte = "é" Then
	            cFinal = cFinal & "&#233;"
	        ElseIf cIte = "ê" Then
	            cFinal = cFinal & "&#234;"
	        ElseIf cIte = "ë" Then
	            cFinal = cFinal & "&#235;"
	        ElseIf cIte = "ì" Then
	            cFinal = cFinal & "&#236;"
	        ElseIf cIte = "í" Then
	            cFinal = cFinal & "&#237;"
	        ElseIf cIte = "î" Then
	            cFinal = cFinal & "&#238;"
	        ElseIf cIte = "ï" Then
	            cFinal = cFinal & "&#239;"
	        ElseIf cIte = "ð" Then
	            cFinal = cFinal & "&#240;"
	        ElseIf cIte = "ñ" Then
	            cFinal = cFinal & "&#241;"
	        ElseIf cIte = "ò" Then
	            cFinal = cFinal & "&#242;"
	        ElseIf cIte = "ó" Then
	            cFinal = cFinal & "&#243;"
	        ElseIf cIte = "ô" Then
	            cFinal = cFinal & "&#244;"
	        ElseIf cIte = "õ" Then
	            cFinal = cFinal & "&#245;"
	        ElseIf cIte = "ö" Then
	            cFinal = cFinal & "&#246;"
	        ElseIf cIte = "÷" Then
	            cFinal = cFinal & "&#247;"
	        ElseIf cIte = "ø" Then
	            cFinal = cFinal & "&#248;"
	        ElseIf cIte = "ù" Then
	            cFinal = cFinal & "&#249;"
	        ElseIf cIte = "ú" Then
	            cFinal = cFinal & "&#250;"
	        ElseIf cIte = "û" Then
	            cFinal = cFinal & "&#251;"
	        ElseIf cIte = "ü" Then
	            cFinal = cFinal & "&#252;"
	        ElseIf cIte = "ý" Then
	            cFinal = cFinal & "&#253;"
	        ElseIf cIte = "þ" Then
	            cFinal = cFinal & "&#254;"
	        ElseIf cIte = "ÿ" Then
	            cFinal = cFinal & "&#255;"
	        Else
	            cFinal = cFinal & cIte
	        End If
	    Next
 	    AscToISO8859Entities = cFinal
	End Function

	Function SHA1( valor )
		Dim objHashedData, InfoSha1
		Set objHashedData = Server.CreateObject("CAPICOM.HashedData")
			objHashedData.Algorithm = CAPICOM_HASH_ALGORITHM_SHA1
			objHashedData.Hash valor
			InfoSha1 = objHashedData.Value					
		Set objHashedData = nothing
		SHA1 = InfoSha1 
	end Function

	Function Encripta( valor, clave )
		Dim objEncryptedData, InfoEncriptada
		Set objEncryptedData = Server.CreateObject("CAPICOM.EncryptedData")
			objEncryptedData.Algorithm = CAPICOM_ENCRYPTION_ALGORITHM_RC2
			objEncryptedData.Content = valor
			objEncryptedData.SetSecret clave
			objEncryptedData.Algorithm.KeyLength = CAPICOM_KEY_LENGTH_MAXIMUM
			InfoEncriptada = objEncryptedData.Encrypt(0)
		Set objEncryptedData = nothing
		Encripta = InfoEncriptada
	end Function

	Function Desencripta( valor, clave )
		Dim objEncryptedData, InfoDesencriptada
		Set objEncryptedData = Server.CreateObject("CAPICOM.EncryptedData")
			objEncryptedData.Algorithm = CAPICOM_ENCRYPTION_ALGORITHM_RC2
			objEncryptedData.Content = valor
			objEncryptedData.SetSecret clave
			InfoDesencriptada = objEncryptedData.Decrypt()
		Set objEncryptedData = nothing
		Desencripta = InfoDesencriptada
	end Function
</SCRIPT>